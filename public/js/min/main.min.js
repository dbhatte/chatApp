"use strict";var chatApp=angular.module("ChatApp",["ngRoute","controllers","directives"]),socket=io();chatApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/login.html",controller:"LoginScreenController"}).when("/chat",{templateUrl:"partials/chat.html",controller:"ChatController"}).otherwise({redirectTo:"/"})}]);var controllers=angular.module("controllers",["services"]);controllers.controller("MainController",["$scope","MessageService","logout",function(a,b,c){a.abort=function(){a.messageObject=b.getMessageObject("Aborting. Please wait",!1,!0),c(function(){a.messageObject=b.getMessageObject("Please take your card",!1,!0)})}}]),controllers.controller("LoginScreenController",["$scope","$location","LoggedInUser","MessageService",function(a,b,c,d){function e(){socket.emit("user connected",c.getUser()),b.path("/chat")}angular.isDefined(c.getUser())&&e(),a.login=function(){a.$parent.messageObject=d.getMessageObject("",!1,!1),a.loginform.$valid&&(console.log(a.username),c.setUser(a.username),e())},a.$parent.messageObject=d.getMessageObject("",!1,!1)}]),controllers.controller("ChatController",["$scope","LoggedInUser","ChatService",function(a,b,c){socket.on("chat message",function(a){$("#messages").append($("<li>").text(a.username+": "+a.message))}),a.sendMessage=function(){c.sendMessage({username:b.getUser(),message:a.message}),a.message=""}}]);var directives=angular.module("directives",[]);directives.directive("message",function(){return{restrict:"E",scope:{data:"="},templateUrl:"/partials/message.html"}}),directives.directive("back",function(){return{template:'<button type="button" class="btn btn-info btn-sm" onclick="window.history.back()">Back</button>'}});var services=angular.module("services",["ngResource","ngCookies"]);services.factory("LoggedInUser",["$cookies",function(a){return{setUser:function(b){a.put("userName",b)},getUser:function(){return a.get("userName")}}}]),services.factory("ChatService",function(){return{sendMessage:function(a){socket.emit("chat message",a)}}}),services.factory("logout",["$timeout","$location",function(a,b){return function(c){a(function(){b.path("/app"),c()},2e3)}}]),services.factory("MessageService",function(){return{getMessageObject:function(a,b,c){return{messageText:a,isError:b,isInfo:c}}}});